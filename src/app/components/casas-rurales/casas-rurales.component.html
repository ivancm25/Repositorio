<app-header></app-header>
<app-submenu></app-submenu>

<div class="container">

  <!-- Listamos las casas rurales registradas -->
  <div class="casas-rurales">
    <h2>Casas rurales en Galicia</h2>

    <div class="busqueda">
      <h3 class="elegirProvincia">Elige la provincia para buscar una casa rural</h3>
      <select [(ngModel)]="provinciaSeleccionada" class="selectProvincia">
        <option value="todas">Todas</option>
        <option value="A Coruña">A Coruña</option>
        <option value="Lugo">Lugo</option>
        <option value="Ourense">Ourense</option>
        <option value="Pontevedra">Pontevedra</option>
      </select>
      <button type="button" class="btn btn-primary" (click)="actualizarCasas()">Buscar</button>
    </div>

    <div class="casa-rural" *ngFor="let item of casasRurales">
      <h2>{{ item.nombre }}</h2>
      <h3>{{ item.provincia }}</h3>
      <p>{{ item.direccion }}</p>
      <p>{{ item.huespedes }} huéspedes máximo</p>
      <p>{{ item.precio }}€</p>
      <button type="button" class="btn btn-primary">Reservar</button>
      <button type="button" class="btn btn-dark" id="reserva" data-toggle="modal" (click)="seleccionarCasa(item)" data-target="#modalReserva">Reservar</button>
    </div>
  </div>

  <hr>

  <button type="button" class="btn btn-info" id="verForm" *ngIf="classReference.logeado" (click)="verFormulario = true">Quieres registrar tu casa rural?</button>

  <!-- Formulario para registrar casa rural -->
  <div class="casaRuralForm" *ngIf="verFormulario">
    <h2>Registrar casa rural</h2>
    <form [formGroup]="casaRuralForm" (ngSubmit)="guardarCasaRural()">
    <div class="form-group">
      <label>Nombre</label>
      <input type="text" formControlName="nombre" class="form-control">
    </div>
    <div class="form-group">
      <label>Provincia</label>
      <select required name="provincia" class="form-control" formControlName="provincia">
        <option value="A Coruña">A Coruña</option>
        <option value="Lugo">Lugo</option>
        <option value="Ourense">Ourense</option>
        <option value="Pontevedra">Pontevedra</option>
      </select>
    </div>
    <div class="form-group">
      <label>Dirección</label>
      <input type="text" formControlName="direccion" class="form-control">
    </div>
    <div class="form-group">
      <label>Teléfono</label>
      <input type="number" formControlName="tlf" class="form-control">
    </div>
    <div class="form-group">
      <label>Precio</label>
      <input type="number" formControlName="precio" class="form-control">
    </div>
    <div class="form-group">
      <label>Huéspedes</label>
      <input type="number" formControlName="huespedes" class="form-control">
    </div>
    <div class="form-check">
      <label class="form-check-label" for="piscina">Tiene piscina?</label>
      <input class="form-check-input" type="checkbox" id="piscina" formControlName="piscina"/><br />

      <label class="form-check-label" for="mascotas">Permite mascotas?</label>
      <input class="form-check-input" type="checkbox" id="mascotas" formControlName="mascotas"/><br />

      <label class="form-check-label" for="fumadores">Permite fumadores?</label>
      <input class="form-check-input" type="checkbox" id="fumadores" formControlName="fumadores"/><br />
    </div>

    <button type="submit" class="btn btn-primary" [disabled]="casaRuralForm.invalid">Registrar</button>
  </form>
  </div>

  <!-- Ventana modal para la reserva -->
<div class="modal fade" id="modalReserva" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">Introduce la fecha de entrada y salida</h2>
      </div>

      <form [formGroup]="reservaForm" class="modal-body">
        <div class="fechas">
          <div class="fechaEntrada">
            <h2>Entrada</h2>
            <mat-card class="demo-inline-calendar-card">
              <mat-calendar (selectedChange)="fechaEntrada = $event"></mat-calendar>
            </mat-card>
            <p>Fecha entrada: {{fechaEntrada}}</p>
          </div>

          <div class="fechaSalida">
            <h2>Salida</h2>
            <mat-card class="demo-inline-calendar-card">
              <mat-calendar (selectedChange)="fechaSalida = $event"></mat-calendar>
            </mat-card>
            <p>Fecha salida: {{fechaSalida}}</p>
          </div>
        </div>


        <div class="botonReserva" *ngIf="comprobarFechas(fechaEntrada, fechaSalida)">
          <h3>{{this.casaRural.nombre}}</h3>
          <h3 id="textoPrecio">El precio total serían {{contarDias(fechaEntrada, fechaSalida) * this.casaRural.precio}}€</h3><br>
          <button type="button" class="btn btn-dark" id="reserva" (click)="reservarCasa(this.casaRural, fechaEntrada, fechaSalida)">Confirmar</button>
        </div>

      </form>
    </div>
  </div>
</div>

</div>






<app-footer></app-footer>
